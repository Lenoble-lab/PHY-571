#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language french
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref true
\pdf_bookmarks true
\pdf_bookmarksnumbered false
\pdf_bookmarksopen false
\pdf_bookmarksopenlevel 1
\pdf_breaklinks false
\pdf_pdfborder true
\pdf_colorlinks false
\pdf_backref false
\pdf_pdfusetitle true
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style french
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Rapport d'EA : résolution numérique du problème à N-corps
\end_layout

\begin_layout Author
Romain Lenoble - Chloé Vernière
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
Déterminer le mouvements de N points en interaction gravitationnelle les
 uns avec les autres est un problème physique fondamental en astronomie.
 Des des méthodes numériques permettent de résoudre ce problème pour un
 grand nombre de particules.
 En particulier, l'algorithme de Barnes-Hut, que nous avons implémenté,
 permet d'obtenir des approximations pour un temps de l'ordre de 
\begin_inset Formula $N\log(N)$
\end_inset

 grâce à une structure en arbre récursive, alors qu'un algorithme naïf serait
 en 
\begin_inset Formula $O(N^{2})$
\end_inset

.
 
\end_layout

\begin_layout Standard
Dans un premier temps, nous allons présenter la méthode générale employée
 pour résoudre ce problème.
 Puis dans un second temps, nous reviendrons sur les résultats que nous
 avons obtenus.
\end_layout

\begin_layout Section
Méthodes pour résoudre le problème à N-corps
\end_layout

\begin_layout Standard

\emph on
Chloé
\end_layout

\begin_layout Subsection
Équation
\end_layout

\begin_layout Standard
Dans un problème gravitationnel à N corps, chaque point i de masse 
\begin_inset Formula $m_{i}$
\end_inset

est soumis à une force gravitationnelle et donc à un potentiel gravitationnel
 par tous les autres points 
\begin_inset Formula $j$
\end_inset

 tels que :
\end_layout

\begin_layout Itemize
\begin_inset Formula $F_{j\rightarrow i}=-G*\frac{m_{i}*m_{j}}{|\vec{r_{j}}-\vec{r}_{i}|^{3}}*(\vec{r_{j}}-\vec{r_{i}})$
\end_inset

 où 
\begin_inset Formula $G=6,67.10^{-11}m^{3}.kg^{-1}.t^{-2}$
\end_inset

 est la constante gravitationnelle, 
\begin_inset Formula $r_{i}$
\end_inset

 et 
\begin_inset Formula $r_{j}$
\end_inset

les positions des masses 
\begin_inset Formula $m_{i}$
\end_inset

et 
\begin_inset Formula $m_{j}$
\end_inset

 ;
\end_layout

\begin_layout Itemize
\begin_inset Formula $E_{ji}=-G*\frac{m_{i}*m_{j}}{(r_{j}-r_{i})}$
\end_inset


\end_layout

\begin_layout Standard
Cependant, l'un des gros problèmes des simulations à N-corps est lorsque
 deux objets se trouvent très proches.
 La trajectoire de chaque particule n'est pas une conique classique comme
 dans le problème à deux corps.
 Lorsque la distance qu'une particule parcourt en une seule itération dépasse
 la distance entre elle-même et une autre particule, une collision s'est
 produite.
 Le problème est que ce genre d’évènement peut modifier énormément l'énergie
 cinétique totale : c'est ce phénomène qui se passe lorsque des particules
 sont éjectées très violemment et sortent du potentiel d'attraction de la
 galaxie dans les simulations.
 Une solution pour limiter ce problème est d’implanter une force modifiée
 à courte portée, de sorte que la force de gravitation soit réduite à courte
 distance.
 Cela peut se traduite par l'ajout d'un paramètre d'atténuation 
\begin_inset Formula $\epsilon=5$
\end_inset

USI.
 
\begin_inset CommandInset citation
LatexCommand cite
key "galaxysimulation"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
Pour chaque point i, on a : 
\begin_inset Formula 
\begin{equation}
m_{i}*\ddot{r_{i}}=-G*m_{i}\sum\frac{m_{j}}{|\vec{r_{j}-}\vec{r_{i}|{}^{2}+\epsilon^{2}}}*\frac{(\vec{r_{j}-}\vec{r_{i})}}{|\vec{r_{j}-}\vec{r_{i}|}}\label{eq:du mouvement}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Calcul numérique
\end_layout

\begin_layout Standard
L'algorithme de Barnes-Hut 
\begin_inset CommandInset citation
LatexCommand cite
key "barnshutalgortihm"
literal "false"

\end_inset

 permet de résoudre les N équations associées aux 
\begin_inset Formula $N^{2}$
\end_inset

interactions en 
\begin_inset Formula $O(N\log N)$
\end_inset

 au lieu de 
\begin_inset Formula $O(N^{2})$
\end_inset

, moyennant des approximations contrôlables.
 Il repose sur un arbre hiérarchique dans lequel sont placés les points
 du système.
 Il fonctionne de la manière suivante : le plan contenant les centres de
 masse est divisé en quatre quadrants, qui sont représentés chacun par une
 branche de l'arbre.
 Chaque quadrant est ensuite divisé en quatre tant qu'il renferme strictement
 plus d'une particule.
 Un arbre résultant avec 1000 particules est présenté en figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "Illustration de l'arbre"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Plus les particules sont réparties de façon non homogène dans l'espace,
 plus l'arbre est donc profond.
 L'apport de l'algorithme pour le calcul d'une force d'interaction exercée
 sur une particule est de ne considérer que le centre de masse du quadrant
 considéré si la taille de celui-ci est plus grande que la distance entre
 la particule et le centre de masse multiplié par un certain angle 
\begin_inset Formula $\theta.$
\end_inset

Nous avons pris 
\begin_inset Formula $\theta=0.7$
\end_inset

<<<<<<< HEAD
conformémant à la littérature.
 Ainsi, si une particule est suffisament éloignée d'un groupe de particules,
 seule l'interaction avec le centre de masse du groupe de particules sera
 calculée, au lieu de la calculer avec chacune des particules du groupe
 : 
=======
 conformément à la littérature.
 Ainsi, si une particule est suffisamment éloignée d'un groupe de particules,
 seule l'interaction avec le centre de masses du groupe de particules sera
 calculé, au lieu de calculer chaque force d'interaction avec les particules
 du groupe : 
>>>>>>> 4eeb1e0cadb770fdd1e7efaa019abbde0db238bf
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Si\frac{l}{d}\leq\theta,\sum F_{j\rightarrow i}=F_{COM\rightarrow i}
\]

\end_inset


\end_layout

\begin_layout Standard
Les feuilles externes de l'arbre contiennent ainsi au plus une particule
 tandis que les nœuds internes contiennent les information des centres de
 masse de leurs enfants.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Quadtree_illustration.png
	scale 60

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "Illustration de l'arbre"

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Illustration de la division du plan selon l'algorithme de Barnes-Hut avec
 1000 particules
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
La hauteur h de l'arbre ainsi construit est en 
\begin_inset Formula $O(ln(N))$
\end_inset

.
 En effet, soit une feuille externe contenant une particule.
 En moyenne, pour une répartition homogène des particules, elle contient
 
\begin_inset Formula $\frac{N}{4^{h}}$
\end_inset

 particules.
 Donc : 
\begin_inset Formula 
\[
1=\frac{N}{4^{h}}\Rightarrow h=O(ln(N))
\]

\end_inset


\end_layout

\begin_layout Standard
Lors du calcul de la force exercée sur sur une particule, l'arbre est parcouru
 en profondeur jusqu'à remplir le critère d'approximation ou tomber sur
 une feuille externe.
 Comme il y a N particules pour une profondeur moyenne de l'arbre en 
\begin_inset Formula $O(ln(N))$
\end_inset

, le calcul de l'ensemble des forces s'effectue donc en 
\begin_inset Formula $O(Nln(N)).$
\end_inset


\end_layout

\begin_layout Subsection
Intégration temporelle
\end_layout

\begin_layout Standard
Une fois l'arbre construit et les interactions entre les N particules calculées,
 il suffit d'intégrer 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:du mouvement"
plural "false"
caps "false"
noprefix "false"

\end_inset

 pour chaque particule afin d'obtenir sa nouvelle position.
 Pour ce faire, nous avons utilisé plusieurs schémas d'intégration d'ordre
 différents, même si la force modifiée permet une plus grande liberté sur
 le pas de temps.
 
\begin_inset CommandInset citation
LatexCommand cite
key "articleN-bodycours"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
Dans la suite, nous notons 
\begin_inset Formula $v_{i}(t)$
\end_inset

 la vitesse de la particule au temps t, 
\begin_inset Formula $r_{i}(t)$
\end_inset

 la position de la particule en t, 
\begin_inset Formula $\Delta t$
\end_inset

 le pas de temps et 
\begin_inset Formula $a_{i}(t)$
\end_inset

 l'accélération en t.
\end_layout

\begin_layout Itemize
Tout d'abord, un schéma d'intégration naïf au premier ordre (ou schéma d'Euler)
 : 
\begin_inset Formula 
\[
v_{i}(t+\Delta t)=\ddot{r_{i}}(t)*\Delta t
\]

\end_inset


\begin_inset Formula 
\[
r_{i}(t+\Delta t)=v_{i}(t)*\Delta t
\]

\end_inset


\end_layout

\begin_layout Standard
Ce schéma au premier ordre est le plus simple qu'il existe, mais ses erreurs
 sont assez importante, notamment pour la conservation de l'énergie.
\end_layout

\begin_layout Itemize
Puis la méthode Leapfrog au second ordre : 
\begin_inset Formula 
\[
v_{i}(t+\Delta t)=v_{i}(t)+\frac{a_{i}(t)+a_{i}(t+\Delta t)}{2}*\Delta t
\]

\end_inset


\begin_inset Formula 
\[
r_{i}(t+\Delta t)=r_{i}(t)+v_{i}(t)*\Delta t+\frac{1}{2}a_{i}(t)*\Delta t^{2}
\]

\end_inset


\end_layout

\begin_layout Standard
Nous avons beaucoup utilisé cette intégrateur car il était très rapide,
 tout en permettant une bonne conservation de l'énergie.
\end_layout

\begin_layout Itemize
Enfin un schéma de Hermite au quatrième ordre : 
\begin_inset Formula 
\[
v_{i}(t+\Delta t)=a_{i}(t)*\Delta t+\frac{1}{2}\dot{a_{i}}(t)*\Delta t^{2}
\]

\end_inset


\begin_inset Formula 
\[
r_{i}(t+\Delta t)=v_{i}(t)*\Delta t+\frac{1}{2}a_{i}(t)*\Delta t^{2}+\frac{1}{6}\dot{a_{i}}(t)*\Delta t^{3}
\]

\end_inset


\end_layout

\begin_layout Standard
\align center
où 
\begin_inset Formula $\dot{a_{i}}=-G\underset{j\neq i}{\sum}m_{j}\frac{x_{ij}^{2}\dot{x_{ij}}-3x_{ij}(\dot{x_{ij}}.x_{ij})}{|x_{ij}|^{5}}$
\end_inset

 correspond à la la dérivée de l'accélération
\end_layout

\begin_layout Standard
Cet intégrateur est le plus précis que nous ayons utilisé.
 Ces équations sont symétriques en temps et donnent une excellente conservation
 de l'énergie.
 Il nécessite cependant de passer par un schéma implicite qui nécessite
 de calculer la dérivée de la force ce qui a un cout de calcul non négligeable.
\end_layout

\begin_layout Standard
Pour la stabilité de chacun des schémas, nous avons choisi pour un pas de
 temps constant.
\end_layout

\begin_layout Section
Simulations réalisées
\end_layout

\begin_layout Standard
Nous avons codé l'algorithme dans le fichier /code du git.
\end_layout

\begin_layout Standard
Au début (pendant les deux premières semaines), nous avons construit notre
 code autour de différentes classes : c'est ce qui nous semblait le plus
 simple au vu de la complexité de l’algorithme.
 Nous avons ainsi créé une classe pour les particules, une pour les nœuds
 de l'arbre et une pour l'arbre en entier.
 La classe particule était particulièrement lourde, elle contenait la vitesse,
 la position, la masse, l'énergie, l’accélération et la force qui s'exerçait
 sur la particule notamment.
 Lorsque nous avons voulu optimiser le code en augmentant le nombre de particule
, nous sommes rapidement arrivés à des problèmes liés à cette structure
 : le code était très lent et nous étions limité en mémoire.
 De plus, les outils vectoriels de Numpy n'étaient pas utilisable avec une
 telle architecture.
\end_layout

\begin_layout Standard
Pour palier à ces problèmes, nous avons réécrit le code en nous affranchissant
 au maximum de la structure de classe et en utilisant des tableaux numpy
 qui sont beaucoup plus rapides à traiter par l'ordinateur.
 Dans la dernière version du code (fichier array_node), nous n'avons plus
 qu'une classe : la classe Node pour coder l'arbre.
 Le reste des données est stocké dans des tableaux où l'indice correspond
 à une particule en particulier.
 Cette nouvelle architecture a permis un gain de temps important, le code
 est près de 10 fois plus rapide, et nous a permis de lancer des calculs
 avec beaucoup plus de particules.
\end_layout

\begin_layout Standard
Les calculs restent tout de même très gourmand en temps, même sur les ordinateur
s des salles d'informatique qui étaient environ dix fois plus rapides que
 nos ordinateurs personnels.
 Nous avons essayé d'optimiser la rapidité du code avec du multiprocessing
 mais l'architecture du code est assez complexe et nécessite d'avoir accès
 au même information en même temps par tout les processeurs.
 La partie la plus gourmande est le calcul des interactions à chaque pas
 de temps entre toutes les particules (en 
\begin_inset Formula $O(Nlog(N))$
\end_inset

).
 Pour chaque particule, nous calculions les interactions avec ses voisines
 selon la descente de l'arbre, comme expliqué plus haut.
 C'est ici que nous aurions voulu utiliser du multiprocessing pour que chaque
 force soit calculée en même temps mais chaque calcul nécessitait l'accès
 aux même données, ce qui ne facilitait pas cette pratique.
\end_layout

\begin_layout Standard
Nous avons uniquement fait des modélisation en 2D mais le code est très
 facilement extensible à la troisième dimension : il suffit d'ajouter une
 dernière dimension dans le choix du huitième de cube dans lequel appartient
 chaque particule au moment de la descente de l'arbre.
\end_layout

\begin_layout Subsection
Vérification de la validité de l'algorithme
\end_layout

\begin_layout Standard
Premièrement, nous avons vérifié si notre algorithme avait une bonne précision.
 Pour cela, nous avons utilisé le problème à deux corps dont la solution
 analytique est connue.
 Nous avons notamment simulé un système Terre-Soleil où l'un des deux corps
 a une masse bien supérieur à l'autre.
\end_layout

\begin_layout Standard
Voilà les résultats obtenus avec ce système, avec les conditions initiales
 du mouvement circulaire uniforme (vitesse nulle pour le soleil et 
\begin_inset Formula $v=\sqrt{G\frac{M}{R}}$
\end_inset

 pour la Terre) et un rapport 
\begin_inset Formula $10^{4}$
\end_inset

 entre les masses (la masse de l'objet central vaut 
\begin_inset Formula $10^{4}$
\end_inset

et celle du satellite) :
\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename graph_terre_soleil_0.002.jpg
	lyxscale 40
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename trace_terre_soleil_0.002.jpg
	lyxscale 40
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Trajectoire (bleu : soleil, orange : Terre)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Dans cette simulation, nous avons utilisé un pas de temps de 0.002 et un
 schéma d'intégration du premier ordre (d'Euler).
 On obtient bien une trajectoire circulaire et l'énergie est bien conservée.
 On peut vérifier les valeurs obtenues par le calcul.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Grandeur
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Valeur
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Énergie potentielle
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{g}=-2G\frac{Mm}{R}=-2.10^{3}[G]J$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Énergie cinétique
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E_{c}=\frac{1}{2}mv^{2}=\frac{GMm}{2R}=500[G]J$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Moment cinétique
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $M=|\vec{p}\wedge\vec{r}|=mvR=316[G]Jm$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Ainsi, l’algorithme est fiable est donne des résultats cohérents pour le
 système à deux corps.
\end_layout

\begin_layout Subsection
Étude des différents schéma d'intégration et des pas de temps
\end_layout

\begin_layout Standard
Comme vu dans la première partie, différents schéma d'intégrations existent.
 Ils donnent des résultats différents selon le pas de temps choisi.
 La principale différence observée est sur la conservation (ou non ) de
 l'énergie.
\end_layout

\begin_layout Standard
Nous allons comparer ici le schéma d'Euler du premier ordre, le schéma leapfrog
 et le schéma du deuxième ordre pour le même pas de temps dans la situation
 précédente.
 Le pas de temps vaut 0.007.
\end_layout

\begin_layout Paragraph
Schéma d'Euler :
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename trace_terre_soleil_0.007_euler_energy.jpg
	lyxscale 40
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename trace_terre_soleil_0.007_euler_trajectoire.jpg
	lyxscale 40
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Trajectoire (bleu : soleil, orange : Terre)
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Schéma Leapfrog :
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename trace_terre_soleil_0.007_leapfrog_energy.jpg
	lyxscale 40
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename trace_terre_soleil_0.007_leapfrog_trajectoire.jpg
	lyxscale 40
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Trajectoire (bleu : soleil, orange : Terre)
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Intégrateur de Hermite développé au 2ème ordre :
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename trace_terre_soleil_0.007_2nd_order_energy.jpg
	lyxscale 40
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename trace_terre_soleil_0.007_2nd_order_trajectoire.jpg
	lyxscale 40
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Trajectoire (bleu : soleil, orange : Terre)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Ainsi, on remarque une bien meilleure conservation de l'énergie pour le
 schéma du deuxième ordre, ce qui était attendu : schéma à l'ordre supérieur
 et symétrique en temps.
 La trajectoire semble cependant identique.
 Pour des simulations beaucoup plus longues, nous avons remarqué que les
 deux premiers schéma conservait mal l'énergie et était très dépendant du
 pas de temps.
 Cependant, le schéma de Hermite au 2ème ordre nécessite de calculer de
 taux de variation de l'accélération.
 Ce calcul est couteux, ce qui rend le code utilisant le schéma de Hermite
 près de 3 fois plus lent que le schéma de leapfrog.
 C'est pour cela que nous avons utilisé ce dernier pour la suite de nos
 simulations.
\end_layout

\begin_layout Standard
On ne peut cependant pas déduire de tels calcul le pas minimal qu'il faut
 adopter pour une simulation.
 En effet, le pas de temps est uniquement utilisé pour déduire l'accélération
 et la vitesse à partir de la force calculée.
 Si la force est très importante, alors l'accélération le sera aussi et
 la vitesse variera beaucoup.
 Le pas de temps devra alors être assez faible pour conserver l'énergie.
 Cette situation est observée lorsque le satellite se rapproche du soleil.
 La force varie de plus énormément avec la position dans ce cas.
\end_layout

\begin_layout Paragraph
Exemple de simulation où le pas de temps est trop petit :
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename trace_terre_soleil_0.007_leapfrog_5_energy.jpg
	lyxscale 40
	scale 30

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename trace_terre_soleil_0.007_leapfrog_5_trajectoire.jpg
	lyxscale 40
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Trajectoire (bleu : soleil, orange : Terre)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Simulation obtenue avec les même paramètre que précédemment mais avec une
 distance de 5 du satellite au soleil.
 Le schéma d'intégration est leapfrog.
\end_layout

\begin_layout Standard
Ainsi, lors d'une simulation avec de nombreuses particules et un point centrale
 très massif (comme c'est le cas dans une galaxie ou pour le système solaire),
 les particules situées proches du centres seront plus sensibles au pas
 de temps.
 Dans nos simulation, nous n'avons pas implémenté de pas de temps variable
 selon la valeur de la force, mais cela aurait pu être un bon prolongement.
\end_layout

\begin_layout Standard
Lors des simulation, nous tirons les particules au hasard.
 Il se peut alors qu'une particule se trouve très proche de l'objet massif
 et perturbe l'énergie totale du système très fortement.
 Pour cela, nous avons imposé un périmètre d'environ 1/10 du rayon de la
 distribution de masse sans particule.
\end_layout

\begin_layout Subsection
Simulations obtenues :
\end_layout

\begin_layout Standard
A l'aide des ordinateurs des salles informatiques, nous avons pu faire des
 calculs avec un grand nombre de particules (plusieurs milliers).
 Ces calculs mettaient plusieurs heures à tourner.
 Nous avions comme objectif d'obtenir des simulations similaires à 
\begin_inset CommandInset citation
LatexCommand cite
key "sitecours"
literal "false"

\end_inset

.
 Pour cela, il nous fallait tout d'abord une simulation viable pour modéliser
 une galaxie.
\end_layout

\begin_layout Standard
Dans toute nos simulation, nous avons pris 
\begin_inset Formula $\theta=0.7$
\end_inset

, qui était la valeur utilisée dans 
\begin_inset CommandInset citation
LatexCommand cite
key "sitecours"
literal "false"

\end_inset

.
 Une valeur plus grande permettait de meilleur calcul mais la conservation
 de l'énergie potentielle n'était pas très bonne.
\end_layout

\begin_layout Subsubsection
Simulation galactique
\end_layout

\begin_layout Standard
La simulation d'une galaxie dépend énormément des conditions initiales :
 masse de trou noir, distribution de masse et de vitesse.
\end_layout

\begin_layout Standard
Pour commencer, nous avons pris une distribution de masse proportionnelle
 à 
\begin_inset Formula $\frac{1}{r}$
\end_inset

 et un vitesse pour chaque particule égale à 
\begin_inset Formula $v(r)=\sqrt{G\frac{M(\leq r)}{R}}$
\end_inset

.
 Cette vitesse assure une stabilité et évite que les particules s'effondrent
 au centre ou se libèrent du potentiel central.
 Nous nous attendons à voir les inhomogénéité de densité lié à l'initialisation
 augmenter jusqu'à former des filaments, à l'image des simulations cosmologiques
 actuelle.
 Cependant, notre simulation est très simpliste et ne prend prend en compte
 que la gravitation : pas de noyau actif de galaxies, de supernovae, d'équations
 de mécanique des fluides.
 Ces phénomènes modifient énormément la morphologie des galaxies.
 Pour toutes ces raisons, notre modèle n'est pas très réaliste.
\end_layout

\begin_layout Standard
Enfin, notre modèle ne représente pas du tout un proto-système solaire car
 nous n'avons pas mis en place de processus d’accrétion entre les particules.
 Il ne prend pas en compte les collisions entre corps.
 Cette approximation est justifiée pour la modélisation d'une galaxie où
 les collisions entre étoiles sont très rares car les distances sont très
 grandes.
 En revanche, les planètes du système solaire se sont formées par accrétion
 successive de corps plus petits, les collisions étaient alors très fréquentes.
\end_layout

\begin_layout Standard
La simulation ci-dessus est la plus grande que nous ayons faite pour une
 galaxie seule.
 Elle inclue 4000 particules réparties aléatoirement suivant une distribution
 en 
\begin_inset Formula $\frac{1}{r}$
\end_inset

.
 Le pas de temps vaut 0.008 et il y a 10000 itérations.
 La masse du trou noir central vaut 
\begin_inset Formula $10^{3}[G]kg$
\end_inset

 et celle des particules élémentaire 
\begin_inset Formula $1[G]kg$
\end_inset

.
 Elle a été calculée sur les ordinateurs de l'X et a mis près de 10h à calculer.
\end_layout

\begin_layout Standard
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename système_solaire/Capture.JPG
	lyxscale 30
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
État initial
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename système_solaire/Capture_1.JPG
	lyxscale 30
	scale 20
	BoundingBox 0bp 0bp 1171bp 850bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
État après 4000 itérations
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename système_solaire/Capture_2.JPG
	lyxscale 30
	scale 20

\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
État final (après 10000 itérations)
\end_layout

\end_inset


\begin_inset Box Frameless
position "t"
hor_pos "c"
has_inner_box 1
inner_pos "t"
use_parbox 0
use_makebox 0
width "45col%"
special "none"
height "1in"
height_special "totalheight"
thickness "0.4pt"
separation "3pt"
shadowsize "4pt"
framecolor "black"
backgroundcolor "none"
status open

\begin_layout Plain Layout
\align left
\begin_inset space \hspace*{\fill}
\end_inset


\begin_inset Graphics
	filename C:/Users/romain Lenoble/Documents/PHY575/Projet/PHY-571/results/syst_solaire_2/syst_solaire_0112_1_graph_energy.jpg
	lyxscale 50
	scale 30
	BoundingBox 0bp 0bp 640bp 480bp

\end_inset


\begin_inset space \hspace*{\fill}
\end_inset


\end_layout

\begin_layout Plain Layout
\align center

\size small
\emph on
Énergie et moment cinétique
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Sur ces quelques images, on remarque que à partir d'une distribution aléatoire,
 on observe rapidement l'émergence de grandes structures filamentaires,
 à l'image des bras observé sur la majorité des galaxies.
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "bibliographie"
options "plain"

\end_inset


\end_layout

\end_body
\end_document
